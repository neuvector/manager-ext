<script>
import NodeDetailsModal from '../components/Nodes/dialogs/NodeDetailsModal';

export default {
  components: {
    NodeDetailsModal
  },
  props: {
    value: {
      type:     Object,
      default:  () => {}
    }
  },
  async fetch() {
  },
  computed: {
    canShow() {
      return this.scanSummary && this.scanSummary.size > 0;
    },
    scanSummary() {
      return this.$store.getters['neuvector/hosts'];
    },
    embededRow() {
      return this.embedHostScanResult(this.scanSummary, this.value);
    }
  },
  methods: {
    embedHostScanResult: (hosts, row) => {
      if (hosts.has(row.id)) {
        row.scanSummary = hosts.get(row.id).scan_summary;
        row.nvId = hosts.get(row.id).id;
      }
      return row;
    },
    openNodeDetailsDialog: function() {
      this.$refs.nodeDetails.show();
    },
  },
};
</script>

<template>
  <div v-if="canShow && embededRow && embededRow.scanSummary">
    <div class="link" @click="openNodeDetailsDialog()">
      <span class="badge badge-danger">{{ embededRow.scanSummary.high }}</span>
      <span class="badge badge-warning">{{ embededRow.scanSummary.medium }}</span>
    </div>
    <NodeDetailsModal ref="nodeDetails" :host="embededRow"></NodeDetailsModal>
  </div>
</template>

<style lang="scss" scoped>
  @import '../styles/neuvector.scss';
  .badge {
      border-radius: 4px;
    }
</style>