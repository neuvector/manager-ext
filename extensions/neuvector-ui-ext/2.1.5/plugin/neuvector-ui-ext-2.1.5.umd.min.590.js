"use strict";(("undefined"!==typeof self?self:this)["webpackChunkneuvector_ui_ext_2_1_5"]=("undefined"!==typeof self?self:this)["webpackChunkneuvector_ui_ext_2_1_5"]||[]).push([[590],{49832:function(e,t,n){n.d(t,{o:function(){return o}});var s=n(32698),i=n(66800),r=n(18420);async function o(e){if(0===e.getters["neuvector/hosts"].length){await(0,r.wN)(e);const t=await(0,i.xI)();sessionStorage.setItem("nv_token",t.data.token.token);const n=await(0,s.E)();e.dispatch("neuvector/updateHosts",a(n.data.hosts))}}function a(e){let t=new Map;return e.forEach((e=>{Object.values(e.interfaces).forEach((n=>{n.forEach((n=>{t.set(n.ip,e)}))})),t.set(e.name.toLowerCase(),e)})),t}},44590:function(e,t,n){n.r(t),n.d(t,{default:function(){return f}});var s=n(9274);const i={key:1};function r(e,t,n,r,o,a){const l=(0,s.resolveComponent)("VulnerabilitiesGrid"),c=(0,s.resolveComponent)("Banner");return(0,s.openBlock)(),(0,s.createElementBlock)("div",null,[o.vulnerabilities&&o.vulnerabilities.length>0?((0,s.openBlock)(),(0,s.createBlock)(l,{key:0,vulnerabilities:o.vulnerabilities,csvFileName:o.rancherHostName},null,8,["vulnerabilities","csvFileName"])):((0,s.openBlock)(),(0,s.createElementBlock)("div",i,[(0,s.createVNode)(c,{class:"type-banner mb-20 mt-0",color:"warning",label:e.t("general.NO_ROWS")},null,8,["label"])]))])}var o=n(32698),a=n(49832),l=n(4850),c=n(9126),u=n(4364),h={components:{Banner:l.l,VulnerabilitiesGrid:c.A},props:{host:Object,isLightTheme:Boolean},async fetch(){try{u.log("Get host vulnerabilities...",this.host);let e="";if(this.host)e=this.host.nvId,this.rancherHostName=this.host.id;else{let t=this.$store.getters["neuvector/hosts"];t&&0!==t.length||(await(0,a.o)(this.$store),t=this.$store.getters["neuvector/hosts"]);let n=location.pathname.split("/"),s=n[n.length-1];t.has(s)&&(e=t.get(s).id),this.rancherHostName=s}const t=this.$store.getters["neuvector/scannedNodeMap"];if(t.has(e))this.vulnerabilities=t.get(e);else{let t=await(0,o.P)(e);this.vulnerabilities=t.data.report.vulnerabilities,this.$store.dispatch("neuvector/updateScannedNodeMap",{nodeID:e,scannedResult:this.vulnerabilities})}}catch(e){u.error(e)}},data(){return{vulnerabilities:null,rancherHostName:""}}},d=n(47433);const v=(0,d.A)(h,[["render",r]]);var f=v},32698:function(e,t,n){n.d(t,{E:function(){return o},P:function(){return a}});var s=n(70344),i=n(18420),r=n(65462);async function o(){return(0,s.A)({url:(0,i.hT)(r.g.NODES_URL),method:"get"})}async function a(e){return(0,s.A)({url:(0,i.hT)(r.g.SCAN_HOST_URL),method:"get",params:{id:e}})}}}]);
//# sourceMappingURL=neuvector-ui-ext-2.1.5.umd.min.590.js.map