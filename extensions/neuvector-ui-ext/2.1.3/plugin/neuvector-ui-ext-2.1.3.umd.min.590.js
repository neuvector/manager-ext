"use strict";(("undefined"!==typeof self?self:this)["webpackChunkneuvector_ui_ext_2_1_3"]=("undefined"!==typeof self?self:this)["webpackChunkneuvector_ui_ext_2_1_3"]||[]).push([[590],{49832:function(e,t,n){n.d(t,{o:function(){return r}});var i=n(32698),s=n(18420);async function r(e){if(0===e.getters["neuvector/hosts"].length){await(0,s.wN)(e);let t=await(0,i.E)();e.dispatch("neuvector/updateHosts",a(t.data.hosts))}}function a(e){let t=new Map;return e.forEach((e=>{Object.values(e.interfaces).forEach((n=>{n.forEach((n=>{t.set(n.ip,e)}))})),t.set(e.name,e)})),t}},44590:function(e,t,n){n.r(t),n.d(t,{default:function(){return f}});var i=n(9274);const s={key:1};function r(e,t,n,r,a,o){const l=(0,i.resolveComponent)("VulnerabilitiesGrid"),c=(0,i.resolveComponent)("Banner");return(0,i.openBlock)(),(0,i.createElementBlock)("div",null,[a.vulnerabilities&&a.vulnerabilities.length>0?((0,i.openBlock)(),(0,i.createBlock)(l,{key:0,vulnerabilities:a.vulnerabilities,csvFileName:a.rancherHostName},null,8,["vulnerabilities","csvFileName"])):((0,i.openBlock)(),(0,i.createElementBlock)("div",s,[(0,i.createVNode)(c,{class:"type-banner mb-20 mt-0",color:"warning",label:e.t("general.NO_ROWS")},null,8,["label"])]))])}var a=n(32698),o=n(49832),l=n(4850),c=n(9126),u=n(4364),h={components:{Banner:l.l,VulnerabilitiesGrid:c.A},props:{host:Object,isLightTheme:Boolean},async fetch(){try{u.log("Get host vulnerabilities...",this.host);let e="";if(this.host)e=this.host.nvId,this.rancherHostName=this.host.id;else{let t=this.$store.getters["neuvector/hosts"];t&&0!==t.length||(await(0,o.o)(this.$store),t=this.$store.getters["neuvector/hosts"]);let n=location.pathname.split("/"),i=n[n.length-1];t.has(i)&&(e=t.get(i).id),this.rancherHostName=i}const t=this.$store.getters["neuvector/scannedNodeMap"];if(t.has(e))this.vulnerabilities=t.get(e);else{let t=await(0,a.P)(e);this.vulnerabilities=t.data.report.vulnerabilities,this.$store.dispatch("neuvector/updateScannedNodeMap",{nodeID:e,scannedResult:this.vulnerabilities})}}catch(e){u.error(e)}},data(){return{vulnerabilities:null,rancherHostName:""}}},d=n(47433);const v=(0,d.A)(h,[["render",r]]);var f=v},32698:function(e,t,n){n.d(t,{E:function(){return a},P:function(){return o}});var i=n(70344),s=n(18420),r=n(65462);async function a(){return(0,i.A)({url:(0,s.hT)(r.g.NODES_URL),method:"get"})}async function o(e){return(0,i.A)({url:(0,s.hT)(r.g.SCAN_HOST_URL),method:"get",params:{id:e}})}}}]);
//# sourceMappingURL=neuvector-ui-ext-2.1.3.umd.min.590.js.map